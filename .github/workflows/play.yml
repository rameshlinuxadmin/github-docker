name: docker push

on:
  push:

jobs:
  docker:
    runs-on: ubuntu-latest
    # Login to Docker Hub
    steps:
      - name: Login to Docker Hub
        uses: docker/login-action@v3
        with:
          username: ${{ secrets.DOCKER_USERNAME }} #docker hub username
          password: ${{ secrets.DOCKER_PASSWORD }} #docker hub access token 

    # Checkout the repo to use the file present in repo  
      - name: checkout
        uses: actions/checkout@v4

    # Push the  built image to the docker hub registry
      #- name: push
      #  uses: docker/build-push-action@v2
      #  with:
      #    context: . #if the file is in the root directory of the repository
          #file: ./docker/Dockerfile #if file is present in different directory, mention absolute path here
      #    push: true
      #    tags: ramesh0112/httpd:${{ github.run_number }} #github.run_number --> this provide run number as tag to image


      - name: Build and Push Image
        run: |
          docker build . -t ${{ secrets.DOCKER_USERNAME }}/httpd:${{ github.run_number }} 
          docker push ${{ secrets.DOCKER_USERNAME }}/httpd:${{ github.run_number }}